
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ | yoyo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="@(å­¦ä¹ èµ„æ–™)[OS, æ–‡ä»¶ç³»ç»Ÿ, Procä¼ªæ–‡ä»¶ç³»ç»Ÿ]

ç†è§£Linuxæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¦‚å¿µ

å²³å‹(yoyo9170@163.com)

ä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†åŠ¨æ€åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¹¶å®Œæˆäº†ç›¸åº”çš„å®éªŒï¼Œæœ¬æ¬¡å®éªŒä¸»è¦è®²è§£å’Œè€ƒå¯Ÿçš„æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä¸­æ ¸å¿ƒä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªæ–¹é¢ï¼šProcæ–‡ä»¶ç³»ç»Ÿä»‹ç»ã€æ–‡ä»¶åˆ›å»ºã€æ–‡ä»¶è¯»å†™ã€å†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´äº¤äº’ã€‚

Procæ–‡ä»¶ç³»ç»Ÿç®€ä»‹ Procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶">
<meta property="og:type" content="article">
<meta property="og:title" content="æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ">
<meta property="og:url" content="http://yoursite.com/2016/01/07/linux-lab6/index.html">
<meta property="og:site_name" content="yoyo">
<meta property="og:description" content="@(å­¦ä¹ èµ„æ–™)[OS, æ–‡ä»¶ç³»ç»Ÿ, Procä¼ªæ–‡ä»¶ç³»ç»Ÿ]

ç†è§£Linuxæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¦‚å¿µ

å²³å‹(yoyo9170@163.com)

ä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†åŠ¨æ€åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¹¶å®Œæˆäº†ç›¸åº”çš„å®éªŒï¼Œæœ¬æ¬¡å®éªŒä¸»è¦è®²è§£å’Œè€ƒå¯Ÿçš„æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä¸­æ ¸å¿ƒä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªæ–¹é¢ï¼šProcæ–‡ä»¶ç³»ç»Ÿä»‹ç»ã€æ–‡ä»¶åˆ›å»ºã€æ–‡ä»¶è¯»å†™ã€å†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´äº¤äº’ã€‚

Procæ–‡ä»¶ç³»ç»Ÿç®€ä»‹ Procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶">
<meta property="og:updated_time" content="2016-01-07T10:40:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ">
<meta name="twitter:description" content="@(å­¦ä¹ èµ„æ–™)[OS, æ–‡ä»¶ç³»ç»Ÿ, Procä¼ªæ–‡ä»¶ç³»ç»Ÿ]

ç†è§£Linuxæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¦‚å¿µ

å²³å‹(yoyo9170@163.com)

ä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†åŠ¨æ€åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¹¶å®Œæˆäº†ç›¸åº”çš„å®éªŒï¼Œæœ¬æ¬¡å®éªŒä¸»è¦è®²è§£å’Œè€ƒå¯Ÿçš„æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä¸­æ ¸å¿ƒä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªæ–¹é¢ï¼šProcæ–‡ä»¶ç³»ç»Ÿä»‹ç»ã€æ–‡ä»¶åˆ›å»ºã€æ–‡ä»¶è¯»å†™ã€å†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´äº¤äº’ã€‚

Procæ–‡ä»¶ç³»ç»Ÿç®€ä»‹ Procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶">
  
    <link rel="alternative" href="/atom.xml" title="yoyo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">yoyo</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">ç å†œã€ç¨‹åºå‘˜ã€æœªæ¥çš„å…¨æ ˆæ”»åŸç‹®</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="yoursite.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-linux-lab6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/07/linux-lab6/" class="article-date">
  <time datetime="2016-01-07T10:26:51.000Z" itemprop="datePublished">2016-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>@(å­¦ä¹ èµ„æ–™)[OS, æ–‡ä»¶ç³»ç»Ÿ, Procä¼ªæ–‡ä»¶ç³»ç»Ÿ]</p>
<blockquote>
<p>ç†è§£Linuxæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¦‚å¿µ</p>
<ul>
<li>å²³å‹(yoyo9170@163.com)</li>
</ul>
<p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†åŠ¨æ€åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¹¶å®Œæˆäº†ç›¸åº”çš„å®éªŒï¼Œæœ¬æ¬¡å®éªŒä¸»è¦è®²è§£å’Œè€ƒå¯Ÿçš„æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä¸­æ ¸å¿ƒä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªæ–¹é¢ï¼š<strong>Procæ–‡ä»¶ç³»ç»Ÿ</strong>ä»‹ç»ã€æ–‡ä»¶åˆ›å»ºã€æ–‡ä»¶è¯»å†™ã€å†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´äº¤äº’ã€‚</p>
</blockquote>
<h3 id="Proc_u6587_u4EF6_u7CFB_u7EDF_u7B80_u4ECB"><a href="#Proc_u6587_u4EF6_u7CFB_u7EDF_u7B80_u4ECB" class="headerlink" title="Procæ–‡ä»¶ç³»ç»Ÿç®€ä»‹"></a>Procæ–‡ä»¶ç³»ç»Ÿç®€ä»‹</h3><p> <code>Procæ–‡ä»¶ç³»ç»Ÿ</code>æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œåªå­˜åœ¨äºå†…å­˜ä¸­ï¼Œé€šè¿‡å®ƒå¯ä»¥æŸ¥è¯¢ã€è®¾ç½®ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µåŠå„ç§ç³»ç»Ÿå‚æ•°ã€‚<br>åœ¨ <code>/proc</code>ç›®å½•ä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶çš„è¯»å†™éƒ½å¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªå†…æ ¸å‡½æ•°ä¸Šï¼›å½“æ–‡ä»¶è¢«è¯»å†™æ—¶ï¼Œè¢«ç»‘å®šçš„ç›¸åº”çš„å†…æ ¸å‡½æ•°å°±ä¼šè¢«è§¦å‘ï¼Œç”±è¿™äº›å‡½æ•°å¤„ç†æ–‡ä»¶çš„è¾“å‡ºä¸è¾“å…¥ã€‚<br>è€Œ <code>/proc</code>ç›®å½•ä¸‹å‡ ä¹åŒ…å«äº†ç³»ç»Ÿæ‰€æœ‰ä¿¡æ¯ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡ <code>Procæ–‡ä»¶ç³»ç»Ÿ</code>æ”¶é›†ç³»ç»Ÿä¿¡æ¯;</li>
<li>ä¹Ÿå¯ä»¥ç”¨äºç¨‹åºè°ƒè¯•;</li>
<li>è¿˜å¯ä»¥åŠ¨æ€çš„ä¿®æ”¹å†…æ ¸çš„æ•°æ®ç»“æ„ï¼Œæ”¹å˜å†…æ ¸çš„è¿è¡ŒçŠ¶æ€</li>
</ul>
<p>å¤§å®¶å¯ä»¥åœ¨è‡ªå·±çš„Linuxç³»ç»Ÿé‡Œï¼Œè¿›å…¥åˆ°<code>/proc</code>ç›®å½•ä¸‹ï¼Œä¼šçœ‹åˆ°å¾ˆå¤šä»¥æ•°å­—å‘½åçš„æ–‡ä»¶å¤¹ï¼Œè¿™äº›ä¸€ä¸ªä¸ªæ•°å­—å³å¯¹åº”ç€è¿›ç¨‹<code>PID</code>ï¼Œæ ¹æ®ä¸Šé¢æåˆ°çš„ä¸‰ç‚¹ï¼Œä¸éš¾ç†è§£è¿™é‡Œä¸»è¦æ”¶é›†ç³»ç»Ÿè¿è¡Œè¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å¯¹åº”å‚æ•°å’Œæ„ä¹‰ä¸ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ–‡ä»¶ï¼ç›®å½•å</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Cmdline</td>
<td style="text-align:center">è¯¥è¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°</td>
</tr>
<tr>
<td style="text-align:center">Cwd</td>
<td style="text-align:center">è¿›ç¨‹è¿è¡Œçš„å½“å‰è·¯å¾„çš„ç¬¦å·é“¾æ¥</td>
</tr>
<tr>
<td style="text-align:center">Environ</td>
<td style="text-align:center">è¯¥è¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒå˜é‡</td>
</tr>
<tr>
<td style="text-align:center">Exe</td>
<td style="text-align:center">è¯¥è¿›ç¨‹ç›¸å…³çš„ç¨‹åºçš„ç¬¦å·é“¾æ¥</td>
</tr>
<tr>
<td style="text-align:center">Fd</td>
<td style="text-align:center">åŒ…å«è¯¥è¿›ç¨‹ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">Maps</td>
<td style="text-align:center">å¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“æ–‡ä»¶çš„å†…å­˜æ˜ åƒ</td>
</tr>
<tr>
<td style="text-align:center">Mem</td>
<td style="text-align:center">è¯¥è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜</td>
</tr>
<tr>
<td style="text-align:center">Root</td>
<td style="text-align:center">è¯¥è¿›ç¨‹æ‰€æœ‰è€…çš„å®¶(home)ç›®å½•</td>
</tr>
<tr>
<td style="text-align:center">Stat</td>
<td style="text-align:center">è¿›ç¨‹çŠ¶æ€</td>
</tr>
<tr>
<td style="text-align:center">Statm</td>
<td style="text-align:center">è¿›ç¨‹çš„å†…å­˜çŠ¶æ€</td>
</tr>
<tr>
<td style="text-align:center">Status</td>
<td style="text-align:center">ç”¨æ˜“è¯»çš„æ–¹å¼è¡¨ç¤ºçš„è¿›ç¨‹çŠ¶æ€</td>
</tr>
</tbody>
</table>
<p>å½“ç„¶<code>/proc</code>ç›®å½•ä¸‹è¿˜æœ‰ä¸€ç³»åˆ—çš„æ–‡ä»¶,è¿™äº›æ–‡ä»¶çš„ä½œç”¨<br>ä¸º:<br>   ç”¨<code>cat   /proc/cpuinfo</code> å‘½ä»¤è·å¾—ç³»ç»Ÿçš„CPUä¿¡æ¯<br>   ç”¨<code>cat  /proc/meminfo</code> å‘½ä»¤è·å¾—ç³»ç»Ÿå†…å­˜ä¿¡æ¯<br>   ç”¨<code>cat  /proc/loadvag</code> å‘½ä»¤è·å¾—CPUå¹³å‡è´Ÿè½½<br>   â€¦â€¦(è¯·å¤§å®¶è‡ªå·±æŸ¥çœ‹)</p>
<h4 id="1_u3001_u6838_u5FC3_u6570_u636E_u7ED3_u6784"><a href="#1_u3001_u6838_u5FC3_u6570_u636E_u7ED3_u6784" class="headerlink" title="1ã€æ ¸å¿ƒæ•°æ®ç»“æ„"></a>1ã€æ ¸å¿ƒæ•°æ®ç»“æ„</h4><ul>
<li>proc_dir_entryç»“æ„</li>
</ul>
<p>ä»£è¡¨å„æ–‡ä»¶èŠ‚ç‚¹,ç®¡ç†æ“ä½œç³»ç»Ÿä»ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´å¯¹æ–‡ä»¶è¯»å†™çš„é©±åŠ¨<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> proc_dir_entry &#123; </span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *name; <span class="comment">//åå­—;</span></span><br><span class="line">	<span class="keyword">mode_t</span> mode; <span class="comment">//æƒé™å±æ€§;</span></span><br><span class="line">	<span class="keyword">nlink_t</span> nlink; <span class="comment">//ç›®å½•ä¸‹å­ç›®å½•çš„æ•°ç›®;</span></span><br><span class="line">	<span class="keyword">read_proc_t</span> *read_proc;<span class="comment">//è¯»æ“ä½œå‡½æ•°</span></span><br><span class="line">	<span class="keyword">write_proc_t</span> *write_proc;<span class="comment">//å†™æ“ä½œå‡½æ•°</span></span><br><span class="line">	<span class="keyword">struct</span> file_operations *proc_fops; <span class="comment">//æ–‡ä»¶æ“ä½œå‡½æ•°; </span></span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2_u3001_u521B_u5EFA_u6587_u4EF6"><a href="#2_u3001_u521B_u5EFA_u6587_u4EF6" class="headerlink" title="2ã€åˆ›å»ºæ–‡ä»¶"></a>2ã€åˆ›å»ºæ–‡ä»¶</h4><ul>
<li>å¤´æ–‡ä»¶<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;linux/proc_fs.h&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">struct</span> proc_dir_entry* <span class="title">create_proc_entry</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, mode_t mode, <span class="keyword">struct</span> proc_dir_entry* parent)</span></span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>name:æ–‡ä»¶å<br>mode:æ–‡ä»¶ç±»å‹å’Œè®¿é—®æƒé™ parent:çˆ¶ç›®å½•,å¦‚æœparentä¸ºæ ¹ç›®å½•,åˆ™ä¸ºNULL<br>è¿”å›å€¼:æˆåŠŸ,è¿”å›æŒ‡å‘æ–‡ä»¶çš„proc_dir_entryç»“æ„æŒ‡é’ˆ.</p>
</blockquote>
<ul>
<li>å®ä¾‹<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo_file = create_proc_entry(â€œfooâ€, <span class="number">0644</span>, example_dir);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3_u3001_u5220_u9664_u6587_u4EF6"><a href="#3_u3001_u5220_u9664_u6587_u4EF6" class="headerlink" title="3ã€åˆ é™¤æ–‡ä»¶"></a>3ã€åˆ é™¤æ–‡ä»¶</h4><p>å†…æ ¸é€šè¿‡å‡½æ•°<code>remove_proc_entry()</code>åˆ é™¤<code>proc</code>æ–‡ä»¶<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove_proc_entry</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">struct</span> proc_dir_entry* parent)</span></span>;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>ä»<code>parent</code>ç›®å½•ä¸‹ç§»é™¤åä¸º<code>name</code>çš„æ–‡ä»¶ <code>proc</code>æ–‡ä»¶ä¸èƒ½ä½¿ç”¨<code>rmdir</code>ã€<code>rm</code>å‘½ä»¤åˆ é™¤,åªèƒ½ä½¿ç”¨ä¸Šè¿°å‡½æ•° åœ¨åˆ é™¤æ–‡ä»¶ä¹‹å‰,å…ˆé‡Šæ”¾<code>proc_dir_entry</code>ç»“æ„ä¸­çš„<code>data</code></p>
</blockquote>
<h4 id="4_u3001_u521B_u5EFA_u76EE_u5F55"><a href="#4_u3001_u521B_u5EFA_u76EE_u5F55" class="headerlink" title="4ã€åˆ›å»ºç›®å½•"></a>4ã€åˆ›å»ºç›®å½•</h4><ul>
<li><p>åˆ›å»ºä¸€ä¸ªç›®å½•</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">struct</span> proc_dir_entry* <span class="title">proc_mkdir</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">struct</span></span><br><span class="line">proc_dir_entry* parent)</span></span>; </span><br><span class="line"><span class="comment">//ç›®å½•åä¸ºname,çˆ¶ç›®å½•ä¸ºparent</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºç¬¦å·è¿æ¥</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">struct</span> proc_dir_entry* <span class="title">proc_symlink</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">struct</span></span><br><span class="line">proc_dir_entry* parent, <span class="keyword">const</span> <span class="keyword">char</span>* dest)</span></span>;</span><br><span class="line"><span class="comment">//åœ¨parentç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåå­—ä¸ºnameçš„ç¬¦å·è¿æ¥,é“¾æ¥ç›®æ ‡æ˜¯dest</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5_u3001_u7528_u6237_u7A7A_u95F4_u4E0E_u5185_u6838_u7A7A_u95F4_u6570_u636E_u4F20_u8F93"><a href="#5_u3001_u7528_u6237_u7A7A_u95F4_u4E0E_u5185_u6838_u7A7A_u95F4_u6570_u636E_u4F20_u8F93" class="headerlink" title="5ã€ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´æ•°æ®ä¼ è¾“"></a>5ã€ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´æ•°æ®ä¼ è¾“</h4><p><code>proc_dir_entry</code>ç»“æ„ä¸­çš„<code>read_proc</code>, <code>write_proc</code>æ˜¯å›è°ƒå‡½æ•°,åˆ†åˆ«å®šä¹‰äº†å¯¹æ–‡ä»¶çš„è¯»å†™å‡½æ•°;</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®ç°è¯»å†™æ–‡ä»¶æ¥å£</span></span><br><span class="line"><span class="keyword">struct</span> proc_dir_entry* foo_file;</span><br><span class="line">foo_file-&gt;read_proc = proc_read_foobar; </span><br><span class="line">foo_file-&gt;write_proc = proc_write_foobar;</span><br></pre></td></tr></table></figure>
<h4 id="6_u3001_u8BFB_u53D6_u6587_u4EF6"><a href="#6_u3001_u8BFB_u53D6_u6587_u4EF6" class="headerlink" title="6ã€è¯»å–æ–‡ä»¶"></a>6ã€è¯»å–æ–‡ä»¶</h4><ul>
<li>è¯»æ–‡ä»¶æ¥å£å‡½æ•°åŸå‹<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read_func</span><span class="params">(<span class="keyword">char</span>* page, <span class="keyword">char</span>** start, off_t off, <span class="keyword">int</span> count, <span class="keyword">int</span>* eof,</span><br><span class="line"><span class="keyword">void</span>* data)</span></span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>å…¶ä¸­ï¼Œ<code>Page</code>æŒ‡é’ˆæŒ‡å‘å°†å†™å…¥æ•°æ®çš„ç¼“å†²åŒº <code>Start</code>è¯´æ˜æ•°æ®å†™åœ¨é¡µé¢çš„ä½ç½® <code>Count</code>å†™å…¥çš„å­—èŠ‚æ•° <code>Offset</code>å†™å…¥æ•°æ®çš„ä½ç½®ç›¸å¯¹äºç¼“å†²åŒºçš„åç§»é‡ <code>Eof</code>è¿”å›å‚æ•°,å½“è¯»åˆ°æ–‡ä»¶ç»“å°¾æ—¶,è¯¥æ ‡å¿—è¢«ç½®ä½ <code>Data</code>ä¿å­˜ç§æœ‰æ•°æ®</p>
</blockquote>
<h4 id="7_u3001_u5199_u5165_u6587_u4EF6"><a href="#7_u3001_u5199_u5165_u6587_u4EF6" class="headerlink" title="7ã€å†™å…¥æ–‡ä»¶"></a>7ã€å†™å…¥æ–‡ä»¶</h4><ul>
<li>å†™æ–‡ä»¶æ¥å£å‡½æ•°åŸå‹<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">write_func</span><span class="params">(<span class="keyword">struct</span> file* file, <span class="keyword">const</span> <span class="keyword">char</span>* buffer, <span class="keyword">unsigned</span> <span class="keyword">long</span> count, <span class="keyword">void</span>*</span><br><span class="line">data)</span></span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>ä»<code>buffer</code>æ•°æ®ç¼“å†²åŒºä¸­è¯»å–<code>count</code>å­—èŠ‚æ•°çš„æ•°æ®,å†™å…¥åˆ°<code>file</code>æ–‡ä»¶<br>ä¸€èˆ¬<code>buffer</code>æŒ‡å‘ç”¨æˆ·ç©ºé—´ç¼“å†²åŒº,åº”å…ˆè°ƒç”¨<code>copy_from_user</code>å°†æ•°æ®æ‹·è´åˆ°å†… æ ¸ç©ºé—´<br>ä¸€èˆ¬çœç•¥<code>file</code>å‚æ•°</p>
</blockquote>
<h3 id="u4EE3_u7801_u793A_u4F8B"><a href="#u4EE3_u7801_u793A_u4F8B" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h3><h4 id="1_u3001_u5B9E_u73B0_u5728/Proc_u76EE_u5F55_u4E0B_u5E8A_u95F4_u4E00_u4E2A_u53EF_u8BFB_u53EF_u5199_u7684my_procfile_1K_u6587_u4EF6"><a href="#1_u3001_u5B9E_u73B0_u5728/Proc_u76EE_u5F55_u4E0B_u5E8A_u95F4_u4E00_u4E2A_u53EF_u8BFB_u53EF_u5199_u7684my_procfile_1K_u6587_u4EF6" class="headerlink" title="1ã€å®ç°åœ¨/Procç›®å½•ä¸‹åºŠé—´ä¸€ä¸ªå¯è¯»å¯å†™çš„my_procfile_1Kæ–‡ä»¶"></a>1ã€å®ç°åœ¨/Procç›®å½•ä¸‹åºŠé—´ä¸€ä¸ªå¯è¯»å¯å†™çš„my_procfile_1Kæ–‡ä»¶</h4><ul>
<li><p><strong>ç¼–å†™ rw_proc.c æ–‡ä»¶,å¦‚ä¸‹</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;linux/proc_fs.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;asm/uaccess.h&gt;</span> /* for copy_from_user */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> PROCFS_MAX_SIZE <span class="number">1024</span> </span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> PROCFS_NAME <span class="string">"my_procfile_1k"</span></span></span><br><span class="line"></span><br><span class="line">MODULE_LICENSE(<span class="string">"GPL"</span>);</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> proc_dir_entry *Our_Proc_File; </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> procfs_buffer[PROCFS_MAX_SIZE]; </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> procfs_buffer_size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">procfile_read</span><span class="params">(<span class="keyword">char</span> *buffer,<span class="keyword">char</span> **buffer_location, off_t offset, <span class="keyword">int</span> buffer_length, <span class="keyword">int</span> *eof,</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> ret;</span><br><span class="line">	<span class="keyword">void</span> *data)</span></span><br><span class="line">	<span class="title">printk</span><span class="params">(KERN_INFO <span class="string">"procfile_read (/proc/%s) called\n"</span>, PROCFS_NAME)</span></span>; </span><br><span class="line">	<span class="keyword">if</span> (offset &gt; <span class="number">0</span>) </span><br><span class="line">	&#123;</span><br><span class="line">		ret=<span class="number">0</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">memcpy</span>(buffer, procfs_buffer, procfs_buffer_size); </span><br><span class="line">		ret = procfs_buffer_size;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">procfile_write</span><span class="params">(<span class="keyword">struct</span> file *file, <span class="keyword">const</span> <span class="keyword">char</span> *buffer, <span class="keyword">unsigned</span> <span class="keyword">long</span> count, <span class="keyword">void</span> *data)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	procfs_buffer_size = count;</span><br><span class="line">	<span class="keyword">if</span>(procfs_buffer_size &gt; PROCFS_MAX_SIZE ) </span><br><span class="line">	&#123; </span><br><span class="line">		procfs_buffer_size = PROCFS_MAX_SIZE;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(copy_from_user(procfs_buffer, buffer, procfs_buffer_size) ) </span><br><span class="line">	&#123; </span><br><span class="line">		<span class="keyword">return</span> EFAULT;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> procfs_buffer_size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">rw_proc_init</span><span class="params">(<span class="keyword">void</span>)</span> </span><br><span class="line"></span>&#123;</span><br><span class="line">	Our_Proc_File = create_proc_entry(PROCFS_NAME, <span class="number">0644</span>, <span class="literal">NULL</span>); </span><br><span class="line">	<span class="keyword">if</span> (Our_Proc_File == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		remove_proc_entry(PROCFS_NAME, &amp;proc_root); </span><br><span class="line">		printk(KERN_ALERT <span class="string">"Error: Could not initialize /proc/%s\n"</span>, PROCFS_NAME);</span><br><span class="line">		<span class="keyword">return</span> ENOMEM;</span><br><span class="line">	&#125;</span><br><span class="line">	Our_Proc_File-&gt;read_proc = procfile_read; </span><br><span class="line">	Our_Proc_File-&gt;write_proc = procfile_write; </span><br><span class="line">	Our_Proc_File-&gt;owner = THIS_MODULE; </span><br><span class="line">	Our_Proc_File-&gt;mode = S_IFREG | S_IRUGO; </span><br><span class="line">	Our_Proc_File-&gt;uid = <span class="number">0</span>;</span><br><span class="line">	Our_Proc_File-&gt;gid = <span class="number">0</span>;</span><br><span class="line">	Our_Proc_File-&gt;size = <span class="number">37</span>;</span><br><span class="line">	printk(KERN_INFO <span class="string">"/proc/%s created\n"</span>, PROCFS_NAME); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">rw_proc_exit</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	remove_proc_entry(PROCFS_NAME, &amp;proc_root);</span><br><span class="line">	printk(KERN_INFO <span class="string">"/proc/%s removed\n"</span>, PROCFS_NAME); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(r w_proc_init);</span><br><span class="line">module_exit(rw_proc_exit);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ä»£ç æ³¨é‡Š</span><br><span class="line">A&gt; Our_Proc_File: /proc æ–‡ä»¶ç³»ç»Ÿä¸‹çš„æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•é¡¹éƒ½å¯¹åº”ä¸€ä¸ªproc_dir_entry ç»“æ„ä½“å®ä¾‹ã€‚</span><br><span class="line">B&gt; procfs_buffer: è¿™ä¸ªç¼“å†²åŒºæ˜¯æˆ‘ä»¬ my_procfile_1k çš„çœŸå®è½½ä½“,æœ¬è´¨ä¸Šæˆ‘ä»¬å°†æ¥å¯¹my_procfile_1k æ–‡ä»¶çš„è¯»å†™éƒ½æ˜¯å¯¹è¯¥ç¼“å†²åŒºçš„è¯»å†™ã€‚</span><br><span class="line">C&gt; PROCFS_MAX_SIZE å’Œ procfs_buffer_size: è¿™ä¸¤ä¸ªå€¼çš„å…³ç³»å°±å¥½æ¯”ä½ æœ‰ 4G(PROCFS_MAX_SIZE)çš„ U ç›˜,é‡Œé¢å·²ç”¨ç©ºé—´ä¸º 2.3G(procfs_buffer_size)ä¸€æ ·ã€‚å› æ­¤æ¯æ¬¡å†™å…¥æ–‡ä»¶</span><br><span class="line">D&gt; procfile_read:æˆ‘ä»¬ä¸ºæ–‡ä»¶ my_procfile_1k å®ç°çš„ read å‡½æ•°ã€‚buffer ä¸ºå†™å‡ºå†…æ ¸ç©ºé—´çš„ç¼“å†²åŒº(ä¸€ä¸ª page å¤§å°),buffer_location æ˜¯ç”¨æ¥å†™å‡ºå¤§äºä¸€ä¸ª page å¤§ å°çš„æ•°æ®æ˜¯ç”¨çš„å‚æ•°ã€‚offset æ˜¯ç”¨æ¥æ ‡è®°ä¸€ä¸ªè¿›ç¨‹ä¸­å¯¹å½“å‰æ–‡ä»¶è¯»å†™çš„åç§»é‡ã€‚ buffer_len æ˜¯è¦è¯»çš„å¤§å°,è¿™é‡Œè¢«å¿½ç•¥æ‰,ç›´æ¥è¿”å›äº†æ–‡ä»¶(buffer)çš„å…¨éƒ¨å†…å®¹ã€‚eof ç”¨æ¥æ ‡è¯†æ–‡ä»¶å·²ç»åˆ°è¾¾æœ«å°¾ã€‚</span><br><span class="line">E&gt; procfile_write:æˆ‘ä»¬ä¸ºæ–‡ä»¶ my_procfile_1k å®ç°çš„ write å‡½æ•°ã€‚ä½¿ç”¨copy_from_user å‡½æ•°çš„åŸå› æ˜¯ buffer æ˜¯ä¸€ä¸ªæŒ‡å‘ç”¨æˆ·åœ°å€ç©ºé—´çš„æŒ‡é’ˆã€‚</span><br><span class="line">F&gt; create_proc_entry:ç”¨æ¥åˆ›å»ºä¸€ä¸ª proc æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å®ä¾‹,åˆ›å»ºç›®å½•å®ä¾‹çš„ å‡½æ•°ä¸º proc_mkdir(char * dirname, struct proc_dir_entr * father_dir);ä¸¤ä¸ªå‡½æ•°çš„æœ«å°¾å‚æ•°ç½® NULL,è¡¨ç¤ºçˆ¶ç›®å½•ä¸º/proc</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¼–å†™ Makefile æ–‡ä»¶</strong></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">KVER=$(<span class="keyword">shell</span> uname -r) </span><br><span class="line">KDIR=/lib/modules/$(KVER)/build </span><br><span class="line"><span class="keyword">PWD</span>=$(<span class="keyword">shell</span> <span class="keyword">pwd</span>)</span><br><span class="line"></span><br><span class="line">obj-<span class="keyword">m</span> += rw_proc.o</span><br><span class="line">default:</span><br><span class="line">	make -C $(KDIR) <span class="keyword">M</span>=$(<span class="keyword">PWD</span>) modules</span><br><span class="line">clean:</span><br><span class="line">	-<span class="keyword">rm</span> *.ko</span><br><span class="line">	-<span class="keyword">rm</span> *.o </span><br><span class="line">	-<span class="keyword">rm</span> -f Mo*</span><br><span class="line">-<span class="keyword">rm</span> *.mod.*</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¼–è¯‘æ¨¡å— #make</strong></p>
</li>
<li><p><strong>å®‰è£…æ¨¡å—</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="id">#insmod</span> <span class="tag">rw_proc</span><span class="class">.ko</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æµ‹è¯•/proc/my_procfile_1k æ–‡ä»¶åŠŸèƒ½</strong> </p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#cat /proc/my_procfile_1k</span></span><br><span class="line"><span class="preprocessor">#ls * &gt; /proc/my_procfile_1k</span></span><br><span class="line"><span class="preprocessor">#cat /proc/my_procfile_1k</span></span><br><span class="line"><span class="preprocessor">#dmesg | tail -10 //æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—é‡Œçš„æ‰“å°ä¿¡æ¯</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å¸è½½æ¨¡å—</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmmod</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="u5B9E_u9A8C_u9898_u76EE"><a href="#u5B9E_u9A8C_u9898_u76EE" class="headerlink" title="å®éªŒé¢˜ç›®"></a>å®éªŒé¢˜ç›®</h3><p>1ã€ï¼ˆè€ƒæŸ¥å†…æ ¸ä¸ç”¨æˆ·ç©ºé—´çš„äº¤äº’æ–¹å¼ï¼‰åœ¨æ–‡æ¡£ä¸­ç»™å‡ºçš„ç¤ºä¾‹ä»£ç ä¸­<code>procfile_read</code>å‡½æ•°é‡Œé¢çš„<code>offset&gt;0</code>åˆ†æ”¯é‡Œé¢æ·»åŠ <code>printk</code>æ‰“å°ä¿¡æ¯åˆ°ç³»ç»Ÿæ—¥å¿—ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªè¯»<code>my_procfile_1k</code>çš„cè¯­è¨€ç¨‹åºã€‚åœ¨ç¨‹åºè·¯å¾ªç¯äº”æ¬¡è¯»å–<code>my_procfile_1k</code>æ–‡ä»¶å¹¶æ‰“å°è¯»å–çš„ä¿¡æ¯ã€‚ï¼ˆè´´å‡ºä»£ç å’Œæˆªå›¾ï¼‰æŸ¥çœ‹å†…æ ¸æ—¥å¿—ä¿¡æ¯ã€‚æƒ³æƒ³ä¸ºä»€ä¹ˆã€‚</p>
<p>2ã€ï¼ˆè€ƒæŸ¥åˆ›å»ºå¯è¯»å†™çš„procæ–‡ä»¶ï¼‰åœ¨<code>/proc</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä»¥<code>task_info</code>ç›®å½•ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ª<code>pid</code>æ–‡ä»¶å’Œ<code>task_info</code>æ–‡ä»¶ï¼š<code>pid</code>æ–‡ä»¶å¯è¯»å†™ï¼Œ<code>task_info</code>æ–‡ä»¶åªè¯»ã€‚è‹¥<code>pid=-1</code>ï¼Œåˆ™<code>task_info</code>æ–‡ä»¶çš„å†…å®¹ä¸ºå½“å‰ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹çš„<code>ID</code>ï¼šåº”ç”¨ç¨‹åºåç§°çš„è®°å½•é›†åˆï¼›è‹¥<code>pid=&gt;0</code>åˆ™<code>task_info</code>ä¸ºè¿›ç¨‹<code>pid</code>çš„è¯¦ç»†ä¿¡æ¯ï¼ˆè‡ªå®šä¹‰ï¼‰ã€‚ï¼ˆè¯·è´´å‡ºä»£ç å¹¶å±•ç¤ºæˆªå›¾ç»“æœï¼‰<br>æç¤º:<br>éå†æ‰€æœ‰è¿›ç¨‹å¯ä»¥ç”¨<code>Linux/sched.h</code>ä¸­çš„<code>for_each_process</code>å®å®ç°ï¼š<br>struct tast_struct  * task;<br>for_each_prcess(task){<br>}</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2016/01/07/linux-lab6/" data-id="cijil286z00026ccs0u44yupa" class="article-share-link" data-share="baidu" data-title="æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ">åˆ†äº«åˆ°</a>
      

      
        <a href="http://yoursite.com/2016/01/07/linux-lab6/#ds-thread" class="article-comment-link">è¯„è®º</a>
      

      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/01/07/linux-lab5/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
      <div class="article-nav-title">æ“ä½œç³»ç»Ÿç¬¬äº”æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”å¯åŠ è½½å†…æ ¸æ¨¡å—</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2016/01/07/linux-lab6/" data-title="æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ" data-url="http://yoursite.com/2016/01/07/linux-lab6/"></div>
  </section>

</section>
      
      <aside id="sidebar">
  
    
  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">ä¸€æœˆ 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">åäºŒæœˆ 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">å…«æœˆ 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">è¿‘æœŸæ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/01/07/linux-lab6/">æ“ä½œç³»ç»Ÿç¬¬å…­æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”Procæ–‡ä»¶ç³»ç»Ÿ</a>
          </li>
        
          <li>
            <a href="/2016/01/07/linux-lab5/">æ“ä½œç³»ç»Ÿç¬¬äº”æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”å¯åŠ è½½å†…æ ¸æ¨¡å—</a>
          </li>
        
          <li>
            <a href="/2016/01/07/Linux-lab4/">æ“ä½œç³»ç»Ÿç¬¬å››æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”åŒæ­¥ä¸äº’æ–¥</a>
          </li>
        
          <li>
            <a href="/2016/01/07/Linux-lab3/">æ“ä½œç³»ç»Ÿç¬¬ä¸‰æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”è¿›ç¨‹é—´é€šä¿¡</a>
          </li>
        
          <li>
            <a href="/2016/01/06/Linux-lab1/">æ“ä½œç³»ç»Ÿç¬¬ä¸€æ¬¡ä¸Šæœºæ•™ç¨‹â€”â€”LinuxåŸºç¡€</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å‹æƒ…é“¾æ¥</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://szm.me/" target="_blank">ä¸€ä¸ªä½è°ƒçš„OSç¥</a>
          </li>
        
          <li>
            <a href="http://peixl.github.io" target="_blank">ä¸€ä¸ªç‚«å¨ƒçš„swiftğŸ¶</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 xpddwn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="è¿”å›é¡¶éƒ¨"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- å¤šè¯´å…¬å…±jsä»£ç  start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"xpddwn"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- å¤šè¯´å…¬å…±jsä»£ç  end -->


<!-- ç™¾åº¦åˆ†äº« start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="åˆ†äº«åˆ°å¾®ä¿¡"></a>
    <a class="article-share-qq" data-cmd="sqq" title="åˆ†äº«åˆ°QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="åˆ†äº«åˆ°äººäººç½‘"></a>
    <a class="article-share-more" data-cmd="more" title="æ›´å¤š"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- ç™¾åº¦åˆ†äº« end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js" type="text/javascript"></script>

</div>
</body>
</html>
